<mxfile host="Electron" modified="2026-02-14T22:00:00.000Z" agent="Mozilla/5.0" etag="abc123" version="24.0.0" type="device">
  <diagram id="security-agent-diagram" name="Security Agent Architecture">
    <mxGraphModel dx="1200" dy="600" grid="1" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="1" pageScale="1" pageWidth="1600" pageHeight="800" math="0" shadow="0">
      <root>
        <mxCell id="0" />
        <mxCell id="1" parent="0" />
        
        <!-- Client Request -->
        <mxCell id="client" value="Client Request&#10;(POST /task)" style="rounded=1;whiteSpace=wrap;html=1;fontSize=12;fontStyle=1;fillColor=#4A90E2;fontColor=#fff;strokeColor=#2E5C8A;strokeWidth=2;" vertex="1" parent="1">
          <mxGeometry x="50" y="200" width="120" height="80" as="geometry" />
        </mxCell>
        
        <!-- Guardian Middleware -->
        <mxCell id="guardian" value="ðŸ›¡ï¸ Guardian&#10;(Redis Check)" style="rounded=1;whiteSpace=wrap;html=1;fontSize=12;fontStyle=1;fillColor=#FF6B6B;fontColor=#fff;strokeColor=#C92A2A;strokeWidth=2;" vertex="1" parent="1">
          <mxGeometry x="200" y="200" width="120" height="80" as="geometry" />
        </mxCell>
        
        <!-- Login Middleware -->
        <mxCell id="login" value="ðŸ” Login&#10;(Whitelist)" style="rounded=1;whiteSpace=wrap;html=1;fontSize=12;fontStyle=1;fillColor=#FFD43B;fontColor=#000;strokeColor=#F08C00;strokeWidth=2;" vertex="1" parent="1">
          <mxGeometry x="350" y="200" width="120" height="80" as="geometry" />
        </mxCell>
        
        <!-- Handler -->
        <mxCell id="handler" value="âš™ï¸ Handler&#10;(Process)" style="rounded=1;whiteSpace=wrap;html=1;fontSize=12;fontStyle=1;fillColor=#51CF66;fontColor=#fff;strokeColor=#2F9E44;strokeWidth=2;" vertex="1" parent="1">
          <mxGeometry x="500" y="200" width="120" height="80" as="geometry" />
        </mxCell>
        
        <!-- Response -->
        <mxCell id="response" value="âœ… Response&#10;(JSON)" style="rounded=1;whiteSpace=wrap;html=1;fontSize=12;fontStyle=1;fillColor=#74C0FC;fontColor=#fff;strokeColor=#1971C2;strokeWidth=2;" vertex="1" parent="1">
          <mxGeometry x="650" y="200" width="120" height="80" as="geometry" />
        </mxCell>
        
        <!-- Blocked -->
        <mxCell id="blocked" value="âŒ Blocked&#10;(403)" style="rounded=1;whiteSpace=wrap;html=1;fontSize=12;fontStyle=1;fillColor=#FF8787;fontColor=#fff;strokeColor=#C92A2A;strokeWidth=2;" vertex="1" parent="1">
          <mxGeometry x="350" y="350" width="120" height="80" as="geometry" />
        </mxCell>
        
        <!-- Log File -->
        <mxCell id="logfile" value="ðŸ“‹ login.log" style="rounded=1;whiteSpace=wrap;html=1;fontSize=12;fontStyle=1;fillColor=#E0AAFF;fontColor=#000;strokeColor=#9C36B5;strokeWidth=2;" vertex="1" parent="1">
          <mxGeometry x="800" y="200" width="120" height="80" as="geometry" />
        </mxCell>
        
        <!-- Reader -->
        <mxCell id="reader" value="ðŸ“– Read Logs" style="rounded=1;whiteSpace=wrap;html=1;fontSize=12;fontStyle=1;fillColor=#748FFC;fontColor=#fff;strokeColor=#5C5CFF;strokeWidth=2;" vertex="1" parent="1">
          <mxGeometry x="950" y="200" width="120" height="80" as="geometry" />
        </mxCell>
        
        <!-- Analyzer -->
        <mxCell id="analyzer" value="ðŸ” Analyze&#10;(>5 failures)" style="rounded=1;whiteSpace=wrap;html=1;fontSize=12;fontStyle=1;fillColor=#748FFC;fontColor=#fff;strokeColor=#5C5CFF;strokeWidth=2;" vertex="1" parent="1">
          <mxGeometry x="1100" y="200" width="120" height="80" as="geometry" />
        </mxCell>
        
        <!-- Blocker -->
        <mxCell id="blocker" value="ðŸš« Block IPs" style="rounded=1;whiteSpace=wrap;html=1;fontSize=12;fontStyle=1;fillColor=#748FFC;fontColor=#fff;strokeColor=#5C5CFF;strokeWidth=2;" vertex="1" parent="1">
          <mxGeometry x="1250" y="200" width="120" height="80" as="geometry" />
        </mxCell>
        
        <!-- Redis -->
        <mxCell id="redis" value="ðŸ”´ Redis&#10;(Blocklist)" style="rounded=1;whiteSpace=wrap;html=1;fontSize=12;fontStyle=1;fillColor=#E0AAFF;fontColor=#000;strokeColor=#9C36B5;strokeWidth=2;" vertex="1" parent="1">
          <mxGeometry x="1250" y="350" width="120" height="80" as="geometry" />
        </mxCell>
        
        <!-- Edges - Main Flow -->
        <mxCell id="edge1" edge="1" parent="1" source="client" target="guardian">
          <mxGeometry relative="1" as="geometry">
            <mxPoint as="sourcePoint" />
          </mxGeometry>
        </mxCell>
        
        <mxCell id="edge2" edge="1" parent="1" source="guardian" target="login">
          <mxGeometry relative="1" as="geometry">
            <mxPoint as="sourcePoint" />
          </mxGeometry>
        </mxCell>
        
        <mxCell id="edge3" edge="1" parent="1" source="login" target="handler">
          <mxGeometry relative="1" as="geometry">
            <mxPoint as="sourcePoint" />
          </mxGeometry>
        </mxCell>
        
        <mxCell id="edge4" edge="1" parent="1" source="handler" target="response">
          <mxGeometry relative="1" as="geometry">
            <mxPoint as="sourcePoint" />
          </mxGeometry>
        </mxCell>
        
        <!-- Edges - Blocked Path -->
        <mxCell id="edge5" edge="1" parent="1" source="guardian" target="blocked">
          <mxGeometry relative="1" as="geometry">
            <mxPoint as="sourcePoint" />
          </mxGeometry>
        </mxCell>
        
        <mxCell id="edge6" edge="1" parent="1" source="login" target="blocked">
          <mxGeometry relative="1" as="geometry">
            <mxPoint as="sourcePoint" />
          </mxGeometry>
        </mxCell>
        
        <!-- Edges - Logging -->
        <mxCell id="edge7" edge="1" parent="1" source="response" target="logfile">
          <mxGeometry relative="1" as="geometry">
            <mxPoint as="sourcePoint" />
          </mxGeometry>
        </mxCell>
        
        <mxCell id="edge8" edge="1" parent="1" source="blocked" target="logfile">
          <mxGeometry relative="1" as="geometry">
            <mxPoint as="sourcePoint" />
          </mxGeometry>
        </mxCell>
        
        <!-- Edges - Agent Flow -->
        <mxCell id="edge9" edge="1" parent="1" source="logfile" target="reader">
          <mxGeometry relative="1" as="geometry">
            <mxPoint as="sourcePoint" />
          </mxGeometry>
        </mxCell>
        
        <mxCell id="edge10" edge="1" parent="1" source="reader" target="analyzer">
          <mxGeometry relative="1" as="geometry">
            <mxPoint as="sourcePoint" />
          </mxGeometry>
        </mxCell>
        
        <mxCell id="edge11" edge="1" parent="1" source="analyzer" target="blocker">
          <mxGeometry relative="1" as="geometry">
            <mxPoint as="sourcePoint" />
          </mxGeometry>
        </mxCell>
        
        <mxCell id="edge12" edge="1" parent="1" source="blocker" target="redis">
          <mxGeometry relative="1" as="geometry">
            <mxPoint as="sourcePoint" />
          </mxGeometry>
        </mxCell>
        
        <!-- Edges - Query Redis -->
        <mxCell id="edge13" edge="1" parent="1" source="guardian" target="redis" style="dashed=1;">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="260" y="280" as="sourcePoint" />
            <mxPoint x="1310" y="350" as="targetPoint" />
          </mxGeometry>
        </mxCell>
      </root>
    </mxGraphModel>
  </diagram>
</mxfile>